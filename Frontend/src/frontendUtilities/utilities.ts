

const computeMonth = (testMonth:number, birthMonth:number, testDay:number, birthDay:number) => {
    if((testDay < birthDay) && (testMonth !== birthMonth)){
        return (11 - (birthMonth - testMonth))
    } 
    
    if(testDay >= birthDay){

        return (12 - (birthMonth - testMonth))
    }

    if(testMonth === birthMonth && (testDay >= birthDay)){
        return 0
    }
}

const computeDay = (testDay:number, birthDay:number, testYear:number, testMonth:number) => {
    if(testDay === birthDay){
        return 0
    }
    if(testDay > birthDay){
        return testDay - birthDay
    }
    return ((new Date(testYear, (testMonth -1), 0).getDate() - birthDay) + testDay)
}

const computeYear = (testMonth:number, birthMonth:number, testYear:number, birthYear:number, testDay:number, birthDay:number) => {
    if(testMonth < birthMonth || (testMonth === birthMonth && testDay < birthDay)){
        return (testYear - birthYear) -1
    }
    return testYear - birthYear
}

const bdScale = {
    "0to3": [[[0],1],[[1],3],[[2],4],[[3],5],[[4,5],6],[[6,7],7],[[8,9],8],[[10,11],9],[[12,13,14],10],[[15,16,17],11],[[18,19,20],12],[[21,22,23],13],[[24,25,26],14],[[27,28,29],15],[[30,31,32],16],[[33,34,35],17],[[36,37,38],18],[[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58],19]],
    "4to7": [[[0],1],[[1],3],[[2],4],[[3],5],[[4,5],6],[[6,7,8],7],[[9,10],8],[[11,12,13],9],[[14,15],10],[[16,17,18],11],[[19,20,21],12],[[22,23,24],13],[[25,26,27],14],[[28,29,30],15],[[31,32,33],16],[[34,35,36],17],[[37,38,39],18],[[40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58],19]],
    "8to11": [[[0],1],[[1],2],[[2],3],[[3],4],[[4],5],[[5,6],6],[[7,8,9],7],[[10,11],8],[[12,13,14],9],[[15,16,17],10],[[18,19,20],11],[[21,22,23],12],[[24,25,26],13],[[27,28],14],[[29,30,31],15],[[32,33,34],16,[[35,36,37],17],[[38,39,40],18],[[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58],19]]]
}

const siScale = {
    "0to3":[[[0],1],[[1],2],[[3],4],[[4,5],5],[[6,7],6],[[8,9],7],[[10,11],8],[[12],9],[[13,14],10],[[15,16],11],[[17,18],12],[[19,20],13],[[21],14],[[22,23],15],[[24],16],[[25,26],17],[[27,28],18],[[29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46],19]],
    "4to7":[[[0],1],[[1],2],[[2],3],[[3,4],4],[[5,6],5],[[7,8],6],[[9,10],7],[[11,12],8],[[13,14],9],[[15,16],10],[[17,18],11],[[19,20],12],[[21],13],[[22],14],[[23],15],[[24,25],16],[[26,27],17],[[28,29],18],[[30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46],19]],
    "8to11":[[[0,1],1],[[2],2],[[3],3],[[4,5],4],[[6,7],5],[[8,9],6],[[10,11],7],[[12,13],8],[[14,15],9],[[16,17],10],[[18,19],11],[[20,21],12],[[22],13],[[23],14],[[24,25],15],[[26],16],[[27,28],17],[[29,30],18],[[31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46],19]]
}

const mrScale = {
    "0to3":[[[0],1],[[1],2],[[2],4],[[3],4],[[4],5],[[5],6],[[6],7],[[7,8],8],[[9],9],[[10,11],10],[[12],11],[[13],12],[[14,15],13],[[16],14],[[17],15],[[18],16],[[19],17],[[20],18],[[21,22,23,24,25,26,27,28,29,30,31,32],19]],
    "4to7":[[[0],1],[[1],2],[[2],3],[[3],4],[[4,5],5],[[6],6],[[7,8],7],[[9],8],[[10],9],[[11,12],10],[[13],11],[[14],12],[[15,16],13],[[17],14],[[18],15],[[19],16],[[20],17],[[21],18],[[22,23,24,25,26,27,28,29,30,31,32],19]],
    "8to11":[[[0],1],[[1],2],[[2,3],3],[[4],4],[[5,6],5],[[7],6],[[8,9],7],[[10],8],[[11],9],[[12,13],10],[[14],11],[[15],12],[[16,17],13],[[18],14],[[19],15],[[20],16],[[21],17],[[22],18],[[23,24,25,26,27,28,29,30,31,32],19]]
}

const dsScale = {
    "0to3":[[[0],1],[[1],2],[[2,3],3],[[4],4],[[5,6],5],[[7,8],6],[[9,10],7],[[11,12],8],[[13,14],9],[[15,16],10],[[17],11],[[18,19],12],[[20],13],[[21,22],14],[[23],15],[[24,24],16],[[26],17],[[27,28],18],[[29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],19]],
    "4to7":[[[0,1],1],[[2],2],[[3,4],3],[[5],4],[[6,7],5],[[8,9],6],[[10,11],7],[[12,13],8],[[14,15],9],[[16,17],10],[[18],11],[[19,20],12],[[21],13],[[22,23],14],[[24],15],[[25,26],16],[[27],17],[[28,29],18],[[30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],19]],
    "8to11":[[[0,1,2],1],[[3,4],2],[[5],3],[[6,7],4],[[8,9],5],[[10,11],6],[[12,13],7],[[14,15],8],[[16],9],[[17,18],10],[[19,20],11],[[21],12],[[22,23],13],[[24],14],[[25,26],15],[[27],16],[[28,29],17],[[30],18],[[31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],19]]
}

const cdScale = {
    "0to3":[[[0,1,2,3,4,5],1],[[6],2],[[7,8],3],[[9,10],4],[[11,12],5],[[13,14],6],[[15,16],7],[[17,18],8],[[19,20,21],9],[[22,23,24],10],[[25,26,27],11],[[28,29,30,31],12],[[32,33,34,35],13],[[36,37,38],14],[[39,40,41],15],[[42,43,44,45],16],[[46,47,48,49,50],17],[[51,52,53,54,55],18],[[56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],19]],
    "4to7":[[[0,1,2,3,4,5,6],1],[[7,8],2],[[9,10],3],[[11,12],4],[[13,14],5],[[15,16],6],[[17,18],7],[[19,20,21],8],[[22,23],9],[[24,25,26],10],[[27,28,29,30],11],[[31,32,33,34],12],[[35,36,37,38],13],[[39,40,41],14],[[42,43,44,45],15],[[46,47,48,49],16],[[50,51,52,53,54],17],[[55,56,57,58,59],18],[[60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],19]],
    "8to11":[[[0,1,2,3,4,5,6,7,8],1],[[9],2],[[10,11],3],[[12,13],4],[[14,15],5],[[16,17],6],[[18,19],7],[[20,21,22],8],[[23,24,25],9],[[26,27,28,29],10],[[30,31,32,33],11],[[34,35,36,37],12],[[38,39,40],13],[[41,42,43,44],14],[[45,46,47,48],15],[[49,50,51,52,53],16],[[54,55,56,57,58],17],[[59,60,61,62,63],18],[[64,65,66,67,68,69,70,71,72,73,74,75],19]]
}

const vcScale = {
    "0to3":[[[0,1],1],[[2],2],[[3],3],[[4,5],4],[[6],5],[[7,8],6],[[9],7],[[10],8],[[11,12],9],[[13],10],[[14],11],[[15,16],12],[[17,18],13],[[19,20],14],[[21,22],15],[[23,24,25],16],[[26,27],17],[[28,29,30],18],[[31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],19]],
    "4to7":[[[0,1],1],[[2],2],[[3,4],3],[[5],4],[[6,7],5],[[8,9],6],[[10],7],[[11],8],[[12,13],9],[[14],10],[[15],11],[[16,17],12],[[18,19],13],[[20,21],14],[[22,23],15],[[24,25,26],16],[[27,28],17],[[29,30,31],18],[[32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],19]],
    "8to11":[[[0,2],1],[[3],2],[[4],3],[[5,6],4],[[7],5],[[8,9],6],[[10,11],7],[[12],8],[[13,14],9],[[15],10],[[16],11],[[17,18],12],[[19,20],13],[[21,22],14],[[23,24],15],[[25,26,27],16],[[28,29],17],[[30,31,32],18],[[32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],19]]
}

const fwScale = {
    "0to3":[[[0],1],[[1],2],[[2],3],[[3],4],[[4,5],5],[[6],6],[[7,8],7],[[9],8],[[10],9],[[11],10],[[12,13],11],[[14],12],[[15,16],13],[[17,18],14],[[19,20],15],[[21,22],16],[[23,24],17],[[25,26],18],[[27,28,29,30,31,32,33,34],19]],
    "4to7":[[[0],1],[[1,2],2],[[3],3],[[4],4],[[5,6],5],[[7],6],[[8,9],7],[[10],8],[[11],9],[[12,13],10],[[14],11],[[15],12],[[16,17],13],[[18],14],[[19,20],15],[[21,22],16],[[23,24],17],[[25,26],18],[[27,28,29,30,31,32,33,34],19]],
    "8to11":[[[0,1],1],[[2],2],[[3],3],[[4,5],4],[[6],5],[[7,8],6],[[9],7],[[10,11],8],[[12],9],[[13,14],10],[[15],11],[[16,17],12],[[18],13],[[19,20],14],[[21,22],15],[[23],16],[[24,25],17],[[26,27],18],[[28,29,30,31,32,33,34],19]]
}

const vpScale = {
    "0to3":[[[0],1],[[1],3],[[2],4],[[3],5],[[4],6],[[5],7],[[6],8],[[7],9],[[8],10],[[9],11],[[10],12],[[11],13],[[12,13],14],[[14,15],15],[[16],16],[[17],17],[[18],18],[[19,20,21,22,23,24,25,26,27,28,29],19]],
    "4to7":[[[0],1],[[1],3],[[2],4],[[3],5],[[4],6],[[5,6],7],[[7],8],[[8],9],[[9],10],[[10],11],[[11],12],[[12,13],13],[[14],14],[[15],15],[[16,17],16],[[18],17],[[19],18],[[20,21,22,23,24,25,26,27,28,29],19]],
    "8to11":[[[0],1],[[1],2],[[2],3],[[3],4],[[4],5],[[5],6],[[6],7],[[7,8],8],[[9],9],[[10],10],[[11],11],[[12],12],[[13],13],[[14,15],14],[[16],15],[[17,18],16],[[19],17],[[20],18],[[21,22,23,24,25,26,27,28,29],19]]
}

const psScale = {
    "0to3":[[[0],1],[[1],2],[[2],3],[[3,4],4],[[5,6],5],[[7,8],6],[[9,10],7],[[11,12],8],[[13,14],9],[[15,16,17],10],[[18,19],11],[[20,21],12],[[22,23,24],13],[[25,26],14],[[27,28,29],15],[[30,31],16],[[32,33,34],17],[[35,36],18],[[37,38,39,40,41,42,43,44,45,46,47,48,49],19]],
    "4to7":[[[0],1],[[1],2],[[2,3],3],[[4,5],4],[[6,7],5],[[8,9],6],[[10,11],7],[[12,13],8],[[14,15,16],9],[[17,18],10],[[19,20],11],[[21,22,23],12],[[24,25],13],[[26,27],14],[[28,29,30],15],[[31,32],16],[[33,34,35],17],[[36,37],18],[[38,39,40,41,42,43,44,45,46,47,48,49],19]],
    "8to11":[[[0],1],[[1,2],2],[[3,4],3],[[5,6],4],[[7,8],5],[[9,10],6],[[11,12],7],[[13,14,15],8],[[16,17],9],[[18,19],10],[[20,21],11],[[22,23,24],12],[[25,26],13],[[27,28,29],14],[[30,31],15],[[32,33],16],[[34,35,36],17],[[37,38],18],[[39,40,41,42,43,44,45,46,47,48,49],19]]
}

const ssScale = {
    "0to3":[[[0],1],[[1],2],[[2],3],[[3,4],4],[[5,6],5],[[7,8],6],[[9,10,11],7],[[12,13,14],8],[[15,16],9],[[17,18,19],10],[[20,21],11],[[22,23,24],12],[[25,26],13],[[27,28,29],14],[[30,31],15],[[32,33],16],[[34,35],17],[[36,37],18],[[38,39,40,41,42],19]],
    "4to7":[[[0],1],[[1],2],[[2,3],3],[[4,5],4],[[6,7],5],[[8,9,10],6],[[11,12,13],7],[[14,15,16],8],[[17,18],9],[[19,20,21],10],[[22,23],11],[[24,25,26],12],[[27,28],13],[[29,30],14],[[31,32],15],[[33,34],16],[[35,36],17],[[37,38],18],[[39,40,41,42],19]],
    "8to11":[[[0,1],1],[[2],2],[[3,4],3],[[5,6],4],[[7,8,9],5],[[10,11,12],6],[[13,14,15],7],[[16,17,18],8],[[19,20],9],[[21,22,23],10],[[24,25],11],[[26,27,28],12],[[29,30],13],[[31,32],14],[[33,34],15],[[35,36],16],[[37,38],17],[[39],18],[[40,41,42],19]]
}

const vciComposite = [[2,45,"<0.1"],[3,50,"<0.1"],[4,55,"0.1"],[5,59,"0.3"],[6,62,"1"],[7,65,"1"],[8,68,"2"],[9,70,"2"],[10,73,"4"],[11,76,"5"],[12,78,"7"],[13,81,"10"],[14,84,"14"],[15,86,"18"],[16,89,"23"],[17,92,"30"],[18,95,"37"],[19,98,"45"],[20,100,"50"],[21,103,"58"],[22,106,"66"],[23,108,"70"],[24,111,"77"],[25,113,"81"],[26,116,"86"],[27,118,"88"],[28,121,"92"],[29,124,"95"],[30,127,"96"],[31,130,"98"],[32,133,"99"],[33,136,"99"],[34,139,"99.5"],[35,142,"99.7"],[36,146,"99.9"],[37,150,">99.9"],[38,155,">99.9"]];
const vsiComposite = [[2,45,"<0.1"],[3,49,"<0.1"],[4,53,"0.1"],[5,57,"0.2"],[6,61,"0.5"],[7,64,"1"],[8,67,"1"],[9,69,"2"],[10,72,"3"],[11,75,"5"],[12,78,"7"],[13,81,"10"],[14,84,"14"],[15,86,"18"],[16,89,"23"],[17,92,"30"],[18,94,"34"],[19,97,"42"],[20,100,"50"],[21,102,"55"],[22,105,"63"],[23,108,"70"],[24,111,"77"],[25,114,"82"],[26,117,"87"],[27,119,"90"],[28,122,"93"],[29,126,"96"],[30,129,"97"],[31,132,"98"],[32,135,"99"],[33,138,"99"],[34,141,"99.7"],[35,144,"99.8"],[36,147,"99.9"],[37,151,">99.9"],[38,155,">99.9"]];
const friComposite = [[2,45,"<0.1"],[3,51,"0.1"],[4,55,"0.1"],[5,58,"0.3"],[6,61,"0.5"],[7,64,"1"],[8,67,"1"],[9,69,"2"],[10,72,"3"],[11,74,"4"],[12,76,"5"],[13,79,"8"],[14,82,"12"],[15,85,"16"],[16,88,"21"],[17,91,"27"],[18,94,"34"],[19,97,"42"],[20,100,"50"],[21,103,"58"],[22,106,"66"],[23,109,"73"],[24,112,"79"],[25,115,"84"],[26,118,"88"],[27,121,"92"],[28,123,"94"],[29,126,"96"],[30,128,"97"],[31,131,"98"],[32,134,"99"],[33,137,"99"],[34,140,"99.6"],[35,144,"99.8"],[36,147,"99.9"],[37,151,">99.9"],[38,155,">99.9"]];
const wmiComposite = [[2,45,"<0.1"],[3,51,"0.1"],[4,55,"0.1"],[5,59,"0.3"],[6,62,"1"],[7,65,"1"],[8,67,"1"],[9,69,"2"],[10,72,"3"],[11,74,"4"],[12,76,"5"],[13,79,"8"],[14,82,"12"],[15,85,"16"],[16,88,"21"],[17,91,"27"],[18,94,"34"],[19,97,"42"],[20,100,"50"],[21,103,"58"],[22,107,"68"],[23,110,"75"],[24,112,"79"],[25,115,"84"],[26,117,"87"],[27,120,"91"],[28,122,"93"],[29,125,"95"],[30,127,"96"],[31,130,"98"],[32,132,"98"],[33,135,"99"],[34,138,"99"],[35,142,"99.7"],[36,146,"99.9"],[37,150,">99.9"],[38,155,">99.9"]];
const psiComposite = [[2,45,"<0.1"],[3,49,"<0.1"],[4,53,"0.1"],[5,56,"0.2"],[6,60,"0.4"],[7,63,"1"],[8,66,"1"],[9,69,"2"],[10,72,"3"],[11,75,"5"],[12,77,"6"],[13,80,"9"],[14,83,"13"],[15,85,"18"],[16,89,"23"],[17,92,"30"],[18,95,"37"],[19,98,"45"],[20,100,"50"],[21,103,"58"],[22,105,"63"],[23,108,"70"],[24,111,"77"],[25,114,"82"],[26,116,"86"],[27,119,"90"],[28,123,"94"],[29,126,"96"],[30,129,"97"],[31,132,"98"],[32,135,"99"],[33,138,"99"],[34,141,"99.7"],[35,144,"99.8"],[36,148,"99.9"],[37,151,">99.9"],[38,155,">99.9"]];
const fsIq = [
    [7,40,"<0.1"],[8,40,"<0.1"],[9,41,"<0.1"],[10,42,"<0.1"],[11,43,"<0.1"],[12,44,"<0.1"],[13,45,"<0.1"],[14,46,"<0.1"],[15,47,"<0.1"],[16,48,"<0.1"],[17,49,"<0.1"],[18,50,"<0.1"],[19,51,"0.1"],[20,52,"0.1"],[21,53,"0.1"],[22,54,"0.1"],[23,55,"0.1"],[24,56,"0.2"],[25,57,"0.2"],[26,58,"0.3"],[27,59,"0.3"],
    [28,60,"0.4"],[29,61,"0.5"],[30,62,"1"],[31,63,"1"],[32,64,"1"],[33,65,"1"],[34,66,"1"],[35,67,"1"],[36,68,"2"],[37,69,"2"],[38,70,"2"],[39,70,"2"],[40,71,"3"],[41,72,"3"],[42,73,"4"],[43,73,"4"],[44,74,"4"],[45,75,"5"],[46,76,"5"],[47,76,"5"],[48,77,"6"],
    [49,78,"7"],[50,79,"8"],[51,80,"9"],[52,80,"10"],[53,82,"12"],[54,83,"13"],[55,84,"14"],[56,85,"16"],[57,86,"18"],[58,87,"19"],[59,88,"21"],[60,89,"23"],[61,91,"27"],[62,92,"30"],[63,93,"32"],[64,94,"34"],[65,95,"37"],[66,96,"39"],[67,97,"42"],[68,98,"45"],[69,99,"47"],
    [70,100,"50"],[71,101,"53"],[72,102,"55"],[73,103,"58"],[74,104,"61"],[75,105,"63"],[76,106,"66"],[77,107,"68"],[78,108,"70"],[79,109,"73"],[80,110,"75"],[81,111,"77"],[82,112,"79"],[83,113,"81"],[84,115,"84"],[85,116,"86"],[86,117,"87"],[87,118,"88"],[88,119,"90"],[89,120,"91"],[90,121,"92"],[91,122,"93"],
    [92,123,"94"],[93,124,"95"],[94,125,"95"],[95,126,"96"],[96,127,"96"],[97,128,"97"],[98,129,"97"],[99,129,"97"],[100,130,"98"],[101,131,"98"],[102,132,"98"],[103,133,"99"],[104,134,"99"],[105,135,"99"],[106,136,"99"],[107,137,"99"],[108,138,"99"],[109,139,"99.5"],[110,140,"99.6"],[111,141,"99.7"],[112,142,"99.7"],
    [113,143,"99.8"],[114,144,"99.8"],[115,145,"99.9"],[116,146,"99.9"],[117,147,"99.9"],[118,148,"99.9"],[119,149,"99.9"],[120,150,">99.9"],[121,151,">99.9"],[122,152,">99.9"],[123,153,">99.9"],[124,154,">99.9"],[125,155,">99.9"],[126,156,">99.9"],[127,157,">99.9"],[128,158,">99.9"],[129,159,">99.9"],[130,160,">99.9"],[131,160,">99.9"],[132,160,">99.9"],[133,160,">99.9"]
]

const getScaledScore = (rawScore:number, arr:any) => {
    for(let i = 0; i < arr.length; i++){
        if(arr[i][0].includes(rawScore)){
            return arr[i][1]
        }
    }
}

const convertRawToScale = (scale:string, rawScore:number, ageMonth:number) => {
    if(ageMonth >= 0 && ageMonth <=3){
        var scoreScale:string = `${scale}[0to3]`
        return getScaledScore(rawScore, scoreScale)
    }
    if(ageMonth >= 4 && ageMonth <=7){
        var scoreScale:string = `${scale}[4to7]`
        return getScaledScore(rawScore, scoreScale)
    }
    var scoreScale:string = `${scale}[8to11]`
    return getScaledScore(rawScore, scoreScale)
}

const convertSumOfScaleToComposite = (sum:number, composite:string) => {
    return composite[sum -2];
}

const getFsIq = (sum:number, arr:any) => {
    return arr[sum -7];
}

export {
    computeDay,
    computeMonth,
    computeYear,
    bdScale,
    siScale,
    mrScale,
    dsScale,
    cdScale,
    vcScale,
    fwScale,
    vpScale,
    psScale,
    ssScale,
    getScaledScore,
    convertRawToScale,
    convertSumOfScaleToComposite,
    getFsIq
}